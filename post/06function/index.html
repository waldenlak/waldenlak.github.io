<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>建站06-添加功能 | 浮光河</title><meta name="keywords" content="hexo,butterfly"><meta name="author" content="惊蛰 子诺,2952068332@qq.com"><meta name="copyright" content="惊蛰 子诺"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="fff"><meta name="referrer" content="no-referrer"><meta name="description" content="查漏补缺教程合集样式美化  ⭐来自主题原作者：Butterfly 美化&#x2F;優化&#x2F;魔改 教程合集 小康博客-Hexo 安装并使用 Butterfly 主题  环境配置、样式美化、功能增加、网站加速   过客～励む-Hexo+github 搭建博客 (超级详细版，精细入微)   史上最全的Hexo博客搭建配置完全指南_云玩家-CSDN博客   Butterfly主题更新总结 | MuJin’s Blog">
<meta property="og:type" content="article">
<meta property="og:title" content="建站06-添加功能">
<meta property="og:url" content="https://fgggh.cn/post/06function/index.html">
<meta property="og:site_name" content="浮光河">
<meta property="og:description" content="查漏补缺教程合集样式美化  ⭐来自主题原作者：Butterfly 美化&#x2F;優化&#x2F;魔改 教程合集 小康博客-Hexo 安装并使用 Butterfly 主题  环境配置、样式美化、功能增加、网站加速   过客～励む-Hexo+github 搭建博客 (超级详细版，精细入微)   史上最全的Hexo博客搭建配置完全指南_云玩家-CSDN博客   Butterfly主题更新总结 | MuJin’s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.xinruiyun.cn/ms-mcms/upload/1/editor/1580979167449.jpg">
<meta property="article:published_time" content="2021-08-31T04:56:50.000Z">
<meta property="article:modified_time" content="2022-08-25T03:31:34.341Z">
<meta property="article:author" content="惊蛰 子诺">
<meta property="article:tag" content="hexo">
<meta property="article:tag" content="butterfly">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.xinruiyun.cn/ms-mcms/upload/1/editor/1580979167449.jpg"><link rel="shortcut icon" href="/img/lo.svg"><link rel="canonical" href="https://fgggh.cn/post/06function/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://unpkg.com/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d39f61f5e8383a45bb1dc9865e20f3a4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://fonts.gstatic.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cormorant:wght@500;600;700&family=Noto+Serif+SC:wght@400;600;700&display=swap" onload="this.media='all'" /></noscript>
<link type="text/css" rel="preload stylesheet" as="style" href="https://fonts.googleapis.com/css2?family=Cormorant:wght@500;600;700&family=Noto+Serif+SC:wght@400;600;700&display=swap" crossorigin ><link rel="stylesheet" href="http://cdn.repository.webfont.com/webfonts/nomal/146144/46888/62fef4a0f629d80380493ca0.css" type="text/css" display="swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"search.local_search.hits_empty"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为夜间模式","night_to_day":"你已切换为日间模式","bgLight":"#ff7242","bgDark":"#ff7242","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://unpkg.com/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://unpkg.com/flickr-justified-gallery/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '建站06-添加功能',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-25 11:31:34'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'fff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css"><link rel="stylesheet" href="/css/design.css"  media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/waldenlak/Art/imgs/t1.jpg" onerror="onerror=null;src='/img/mo.gif'" alt="avatar"/></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/mdcloud/"><span> 云端</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> 藏宝图</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/books/"><i class="fa-fw ri-pantone-fill"></i><span> 书</span></a></li><li><a class="site-page child" href="/vedio/"><i class="fa-fw ri-movie-2-fill"></i><span> 影</span></a></li><li><a class="site-page child" href="/exhibit/"><i class="fa-fw ri-coupon-3-fill"></i><span> 展</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> 案台</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><span> 时间轴</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><div id="site-name"><a href="/">浮光河</a></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/mdcloud/"><span> 云端</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> 藏宝图</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/books/"><i class="fa-fw ri-pantone-fill"></i><span> 书</span></a></li><li><a class="site-page child" href="/vedio/"><i class="fa-fw ri-movie-2-fill"></i><span> 影</span></a></li><li><a class="site-page child" href="/exhibit/"><i class="fa-fw ri-coupon-3-fill"></i><span> 展</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> 案台</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><span> 时间轴</span></a></li></ul></div></div><button id="search"><a class="site-page social-icon search"><i class="ri-search-2-line"></i></a></button></div><div id="nav-r"><div id="menuo"><button id="darkmode" type="button" title="日间和夜间模式转换"><i class="ri-moon-fill"></i></button></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div class="post-page"><div id="post-info"><h1 class="post-title">建站06-添加功能</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="ri-calendar-event-fill post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-08-31T04:56:50.000Z" title="发表于 2021-08-31 12:56:50">2021-08-31</time><span class="post-meta-separator"> </span><i class="ri-refresh-line post-meta-icon"></i><span class="post-meta-label">编辑于</span><time class="post-meta-date-updated" datetime="2022-08-25T03:31:34.341Z" title="编辑于 2022-08-25 11:31:34">2022-08-25</time></span><span class="post-meta-categories"><span class="post-meta-separator"> </span><a class="post-meta-categories" href="/categories/%E7%90%86%E5%B7%A5/">理工</a><i class="ri-arrow-right-s-line post-meta-separator"></i><a class="post-meta-categories" href="/categories/%E7%90%86%E5%B7%A5/%E7%BC%96%E7%A8%8B/">编程</a></span></div><div class="meta-secondline"><span class="post-meta-wordcount"><i class="ri-file-list-3-line post-meta-icon"></i><span class="post-meta-label">字数 </span><span class="word-count">4.4k</span><span class="post-meta-separator"> </span><i class="ri-timer-line post-meta-icon"></i><span class="post-meta-label">阅读时长 </span><span>18分钟</span></span><span class="post-meta-separator"> </span><span class="post-meta-pv-cv" id="" data-flag-title="建站06-添加功能"><i class="ri-fire-fill post-meta-icon"></i><span class="post-meta-label">阅读 </span><span id="busuanzi_value_page_pv"></span><span class="post-meta-label">次</span></span></div></div></div><div class="paper"><article class="post-content" id="article-container"><details class="toggle" ><summary class="toggle-button" style="">查漏补缺教程合集</summary><div class="toggle-content"><p>样式美化</p>
<ul>
<li>⭐来自主题原作者：<a target="_blank" rel="noopener" href="https://butterfly.js.org/posts/7670b080/">Butterfly 美化/優化/魔改 教程合集</a></li>
<li><a target="_blank" rel="noopener" href="https://www.antmoe.com/posts/75a6347a/index.html">小康博客-Hexo 安装并使用 Butterfly 主题</a></li>
</ul>
<p>环境配置、样式美化、功能增加、网站加速</p>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="https://yafine-blog.cn/posts/4ab2.html">过客～励む-Hexo+github 搭建博客 (超级详细版，精细入微)</a></p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42579187/article/details/104760516">史上最全的Hexo博客搭建配置完全指南_云玩家-CSDN博客</a></p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://xiabor.com/4215.html">Butterfly主题更新总结 | MuJin’s Blog</a></p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="http://yearito.cn/posts/hexo-advanced-settings.html">next主题-数据统计、站内搜索、热门文章排行榜、豆瓣阅读 / 电影 / 游戏、在线聊天、行为监测与反馈、文章评分</a></p>
</li>
</ul>
</div></details>
<span id="more"></span>
<h1 id="一-引擎优化篇"><a class="markdownIt-Anchor" href="#一-引擎优化篇"></a> 一、引擎优化篇</h1>
<h2 id="一访问加速"><a class="markdownIt-Anchor" href="#一访问加速"></a> （一）访问加速</h2>
<h3 id="cdn加速"><a class="markdownIt-Anchor" href="#cdn加速"></a> CDN加速</h3>
<dl>
<dt>作用</dt>
<dd>将网站图片、视频、字体等可能在网站仓库占用体积大的资源放入一个新的云仓库，如<code>GitHub Repo</code>，为部署网站减负。</dd>
<dd>加速访问<code>GitHub</code>、<code>npm</code>、<code>wordpress</code>的<code>js</code>插件或资源目录。</dd>
</dl>
<p>官网：<a target="_blank" rel="noopener" href="https://www.jsdelivr.com/">https://www.jsdelivr.com/</a><br>
使用教程：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/murenziwei/p/12747311.html">好用的jsDelivr</a>；<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/346643522">如何使用jsDelivr+Github 实现免费CDN加速?</a></p>
<h3 id="跳过hexo的渲染"><a class="markdownIt-Anchor" href="#跳过hexo的渲染"></a> 跳过HEXO的渲染</h3>
<p><a target="_blank" rel="noopener" href="https://xiabor.com/714f.html">MuJin’s Blog-Hexo大结局</a></p>
<h2 id="二双线部署自动部署教程"><a class="markdownIt-Anchor" href="#二双线部署自动部署教程"></a> （二）双线部署+自动部署教程</h2>
<h3 id="镜像备份"><a class="markdownIt-Anchor" href="#镜像备份"></a> 镜像备份</h3>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46157986/article/details/109530672">Gitee导入Github仓库并同步更新-theONLY-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://gitee.com/help/articles/4336">仓库镜像管理 Gitee↔Github双向同步</a></p>
<h3 id="自动部署"><a class="markdownIt-Anchor" href="#自动部署"></a> 自动部署</h3>
<p>自动部署即持续集成，通过一次配置部署方案，省去每次修改源码后手动<code>deploy</code>的时间。</p>
<blockquote>
<p>传统的 hexo 博客更新过程是：在完成写作之后，利用命令行调用 hexo g &amp;&amp; hexo d 来生成静态博客文件以及并推送到远端的仓库中。这种方法会产生三个痛点：</p>
<ol>
<li>每一次修改源文件后都需要重新生成一边静态文件，当大量修改时，步骤就变得繁琐且无趣。</li>
<li>生成静态文件依赖电脑中的 hexo 和 node.js 环境，不方便在外出时临时写或修改博客。</li>
<li>博客源文件没有自动的备份功能，不符合安全原则。</li>
</ol>
</blockquote>
<p>配置GitHub Action、Travis CI、Vercel等持续集成工具能解决以上痛点。</p>
<p>注意源码存放位置有两种方案：</p>
<ol>
<li>把源码放在私库里，生成网页文件在公库上。</li>
<li>使用一个公库，两个分支（生成网页文件分支，即默认分支<code>master</code>；源码文件分支<code>hexo</code>）。</li>
</ol>
<p>情况不同，具体配置细节不同。<br>
源码仓库在coding上，参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/sviptzk/article/details/104237623">Hexo+coding实现自动化部署</a>。</p>
<h4 id="github-action语雀"><a class="markdownIt-Anchor" href="#github-action语雀"></a> Github Action+语雀</h4>
<p><code>Github Action</code>，完全免费的GitHub持续集成工具。<br>
<code>语雀</code>是在线知识协作平台，可以创建文档、图片等资源项目，这里把它用作富文本显示的md编辑器，使用体验比目前主流md编辑器更美观，并且有<a target="_blank" rel="noopener" href="https://github.com/x-cold/yuque-hexo">插件(yuque-hexo)</a>支持修改语雀文章即自动同步更新到网站。<br>
语雀同步配置以及Github Action整体配置的手把手详细步骤参考：<br>
⭐<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_33625877/article/details/114097105">hexo×语雀 实现云端富文本写作 - 小冰博客</a>；<a target="_blank" rel="noopener" href="https://www.zhwei.cn/hexo-github-actions-yuque">Hexo：语雀云端写作 Github Actions 持续集成 | HONGWEI</a>（<a target="_blank" rel="noopener" href="https://blog.csdn.net/z_johnny/article/details/104629805/">CSDN地址</a>）；<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36535538/article/details/123749206">yuque-hexo：语雀写文，自动部署 Hexo 博客 - CSDN</a>。<br>
语雀上的<code>front-matter</code>模板格式与行文格式参考<a target="_blank" rel="noopener" href="https://www.yuque.com/u46795/blog/dlloc7#8072e205">Hexo 博客终极玩法：云端写作，自动部署</a>（②<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000017797561">思否地址</a>③<a target="_blank" rel="noopener" href="http://www.javashuo.com/article/p-gsjyyeuz-bw.html">JavaShuo地址</a>）；<a target="_blank" rel="noopener" href="https://blog.ccknbc.cc/posts/special-test-article/">语雀专用测试文章</a>。</p>
<div class="tabs" id="g"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#g-1">网站源文件配置</button></li><li class="tab"><button type="button" data-href="#g-2">云函数配置</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="g-1"><p>①安装yuque-hexo插件（<code>npm i --save-dev yuque-hexo</code>）</p>
<p>②修改根目录下的package.json：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;build&quot;</span>: <span class="string">&quot;hexo generate&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;clean&quot;</span>: <span class="string">&quot;hexo clean&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;deploy&quot;</span>: <span class="string">&quot;hexo deploy&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;server&quot;</span>: <span class="string">&quot;hexo server&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;sync&quot;</span>: <span class="string">&quot;yuque-hexo sync&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;clean:yuque&quot;</span>: <span class="string">&quot;yuque-hexo clean&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;reset&quot;</span>: <span class="string">&quot;npm run clean:yuque &amp;&amp; npm run sync&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">&quot;yuqueConfig&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;postPath&quot;</span>: <span class="string">&quot;source/_posts/a&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;mdNameFormat&quot;</span>: <span class="string">&quot;title&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;adapter&quot;</span>: <span class="string">&quot;markdown&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;lastGeneratePath&quot;</span>: <span class="string">&quot;./yuque-lastgeneratetimestamp.txt&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;concurrency&quot;</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">&quot;baseUrl&quot;</span>: <span class="string">&quot;https://www.yuque.com/api/v2&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;login&quot;</span>: <span class="string">&quot;****&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;repo&quot;</span>: <span class="string">&quot;****&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;*****&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;onlyPublished&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;onlyPublic&quot;</span>: <span class="literal">true</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p><code>login</code>填语雀设置的用户个人路径字符，<code>repo</code>填语雀知识库的路径字符，<code>token</code>填语雀设置的Token字符，其他参数可参考<a target="_blank" rel="noopener" href="https://github.com/x-cold/yuque-hexo">官方解释</a>自定义配置。</p>
<p>③备份好<code>_post</code>文件夹后，本地终端运行<code>yuque-hexo sync</code>下载语雀文章，运行<code>yuque-hexo clean</code>清除语雀文章，运行<code>hexo g &amp; hexo s</code>本地调试效果。</p>
<p>④新建<code>\.github\workflows\autodeploy.yml</code>：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">name:</span> <span class="string">自动部署</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 当有改动推送和语雀发布时，启动Action</span></span><br><span class="line"><span class="attr">on:</span> [<span class="string">push</span>, <span class="string">repository_dispatch</span>]</span><br><span class="line"> </span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">deploy:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">windows-latest</span> <span class="comment">#运行环境</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">检查分支</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2.3.1</span> <span class="comment">#小步骤使用的别人写好的 actions 库名称或路径</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">ref:</span> <span class="string">hexo</span></span><br><span class="line"> </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装</span> <span class="string">Node</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&quot;12.x&quot;</span></span><br><span class="line"> </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          export TZ=&#x27;Asia/Shanghai&#x27;</span></span><br><span class="line"><span class="string">          npm install hexo-cli -g</span></span><br><span class="line"><span class="string"></span>        <span class="comment">#npm install gulp-cli -g如果你有使用gulp的话，打开这一行</span></span><br><span class="line">          <span class="string">npm</span> <span class="string">install</span> <span class="string">yuque-hexo</span> <span class="string">-g</span></span><br><span class="line">          <span class="string">yuque-hexo</span> <span class="string">clean</span></span><br><span class="line">          <span class="string">yuque-hexo</span> <span class="string">sync</span></span><br><span class="line"> </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">更新</span> <span class="string">语雀拉取缓存及文章</span> <span class="comment">#更新yuque 拉取的文章到GitHub仓库</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          echo `date +&quot;%Y-%m-%d %H:%M:%S&quot;` begin &gt; time.log</span></span><br><span class="line"><span class="string">          git config --global user.email &quot;name@mail.com&quot;</span></span><br><span class="line"><span class="string">          git config --global user.name &quot;username&quot;</span></span><br><span class="line"><span class="string">          git add .</span></span><br><span class="line"><span class="string">          git commit -m &quot;Refresh yuque json&quot; -a</span></span><br><span class="line"><span class="string"></span> </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">推送</span> <span class="string">语雀拉取缓存及文章</span> <span class="comment">#推送修改后的yuque.json</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">ad-m/github-push-action@hexo</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">github_token:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITHUB_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line"> </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">缓存</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/cache@v1</span></span><br><span class="line">        <span class="attr">id:</span> <span class="string">cache</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">node_modules</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">$&#123;&#123;runner.OS&#125;&#125;-$&#123;&#123;hashFiles(&#x27;**/package-lock.json&#x27;)&#125;&#125;</span></span><br><span class="line"> </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装依赖</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">steps.cache.outputs.cache-hit</span> <span class="type">!=</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          npm install --save</span></span><br><span class="line"><span class="string"></span> </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">生成静态文件</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          hexo clean</span></span><br><span class="line"><span class="string">          hexo g</span></span><br><span class="line"><span class="string"></span>        <span class="comment">#gulp如果你有使用gulp的话，打开这一行</span></span><br><span class="line"> </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">部署</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          git config --global user.name &quot;username&quot;</span></span><br><span class="line"><span class="string">          git config --global user.email &quot;name@mail.com&quot;</span></span><br><span class="line"><span class="string">          hexo deploy</span></span><br></pre></td></tr></table></figure>
<p>将<code>name@mail.com</code>和<code>username</code>修改成自己的配置即可。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="g-2"><p>百度智能云或腾讯云登录云函数：<br>
①新建空白函数；自定义函数名称，运行环境选择<code>python</code>，超时设置10s；<br>
②百度智能云触发器选择<code>HTTP 触发器</code>，，URL路径填<code>/</code>，HTTP 方法选择<code>POST</code>和<code>GET</code>；腾讯云触发管理新建<code>API网关触发器</code>，复制配置好后的访问路径。<br>
③进入代码编辑页面，输入以下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main_handler</span>(<span class="params">event, context</span>):</span></span><br><span class="line">    r = requests.post(<span class="string">&quot;https://api.github.com/repos/usernamme/reponame/dispatches&quot;</span>,</span><br><span class="line">    json = &#123;<span class="string">&quot;event_type&quot;</span>: <span class="string">&quot;start&quot;</span>&#125;,</span><br><span class="line">    headers = &#123;<span class="string">&quot;User-Agent&quot;</span>:<span class="string">&#x27;curl/7.52.1&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;application/vnd.github.everest-preview+json&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">&#x27;token *****&#x27;</span>&#125;)</span><br><span class="line">    <span class="keyword">if</span> r.status_code == <span class="number">204</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;This&#x27;s OK!&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> r.status_code</span><br></pre></td></tr></table></figure>
<p>将<code>usernamme</code>、<code>reponame</code>、<code>token *****</code>分别改为自己的GitHub用户名、源码仓库名与私钥。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<h4 id="travis-ci语雀"><a class="markdownIt-Anchor" href="#travis-ci语雀"></a> Travis CI+语雀</h4>
<p>关于<code>Travis CI</code>：</p>
<blockquote>
<p>是一个提供持续集成功能的平台，目前有两个站点:</p>
<ol>
<li><a target="_blank" rel="noopener" href="http://Travis.org">Travis.org</a> 对于所有<code>public</code>项目完全免费</li>
<li><a target="_blank" rel="noopener" href="http://Travics.com">Travics.com</a> 只针对<code>private</code>项目，提供一些额外功能，如cache，并行build个数<br>
两个站点只能看到各自的项目，不能通用。<br>
可配置GitHub、coding、gitee等代码仓库的自动部署。</li>
</ol>
</blockquote>
<div class="tabs" id="c"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#c-1">参考教程</button></li><li class="tab"><button type="button" data-href="#c-2">Travis CI配置</button></li><li class="tab"><button type="button" data-href="#c-3">网站源文件配置</button></li><li class="tab"><button type="button" data-href="#c-4">云函数配置</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="c-1"><ul>
<li>配置逻辑：<a target="_blank" rel="noopener" href="http://www.itfanr.cc/2017/08/09/using-travis-ci-automatic-deploy-hexo-blogs/">使用Travis CI自动部署Hexo博客 | IT范儿</a>另一地址：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/babycool/p/7326722.html">使用Travis CI自动部署Hexo博客 - 酷小孩 - 博客园</a></li>
<li>自定义commit内容：①时间<a target="_blank" rel="noopener" href="http://xiang578.com/post/use-travis-ci-to-auto-build-blog.html">博客折腾记：使用 Travis CI 自动部署博客 | 算法花园</a>②数字，邮件通知<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42465158/article/details/112720613">构建指定仓库_使用Travis CI自动构建和部署你的GitBook</a></li>
<li>通配变量名：<a target="_blank" rel="noopener" href="https://www.freesion.com/article/80151075945/">使用TRAVIS-CI自动部署GITHUB上的项目 - 灰信网</a>；<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/85175312">利用Travis CI+GitHub实现持续集成和自动部署 - 知乎</a></li>
<li>设置操作系统：<a target="_blank" rel="noopener" href="https://blog.travis-ci.com/2018-10-11-windows-early-release">The Travis CI Blog: Windows is Available (Early Release)</a></li>
<li>设置语言版本：<a target="_blank" rel="noopener" href="https://github.com/jasongin/nvs/issues/122#issuecomment-455864030">“nvs add stable” fails on Windows</a></li>
<li>coding配置与双线域名解析：<a target="_blank" rel="noopener" href="https://blog.csdn.net/ayuayue/article/details/109198497">使用travisCI自动部署hexo博客并使用国内外不同dns-caoayu-CSDN博客</a></li>
</ul>
<p>可以在<a target="_blank" rel="noopener" href="https://app.travis-ci.com/">travis的项目页</a>的源码仓库点击<code>Build History</code>-<code>Build job</code>查看执行记录，也可以通过设置邮件通知直达执行记录，判断是否成功部署。</p>
<p>Travis CI自动部署配置成功后，可直接推送源码更改至<code>hexo</code>分支（自设的源码分支名或源码仓库的默认分支名），然后自动生成网页文件到配置的生成网页仓库地址，不用再<code>hexo clean</code>+<code>hexo g</code>+<code>hexo d</code>三连。<br>
更新方法可参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Akkuman/p/9607513.html">使用Travis CI自动部署博客到github pages和coding pages - Akkuman - 博客园</a>的题外话部分。<br>
<code>coding</code>的配置可参考<a target="_blank" rel="noopener" href="http://xiang578.com/post/use-travis-ci-to-auto-build-blog.html">博客折腾记：使用 Travis CI 自动部署博客</a>。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="c-2"><p>Travis CI网站开启仓库管理，配置仓库设置的环境变量:</p>
<ol>
<li><code>CO_REF</code>: Coding生成网页文件仓库地址。格式：<code>github.com/username/username.github.io.git</code></li>
<li><code>Abcdefghij</code>: Coding的个人访问令牌处的令牌用户名，每个人不相同。（以前的方法设<code>Coding_Token</code>行不通，当前无法自定义令牌名用到Travis上）</li>
<li><code>CO_N</code>：coding的个人账户手机号或邮箱。（最好用手机号，邮箱的<code>@</code>要转义）</li>
<li><code>GH_REF</code>：GitHub生成网页文件仓库地址。格式：<code>e.coding.net/username/username.git</code></li>
<li><code>Travis_Token</code>：GitHub配置的Travis CI令牌</li>
<li><code>U_EMAIL</code>：GitHub注册邮箱</li>
<li><code>U_NAME</code>：GitHub用户名称</li>
<li><code>YUQUE_TOKEN</code>：语雀用户设置的token</li>
</ol>
<p>不论是将源码与生成网页放在两个仓库（后者的情况要对源码仓库进行配置变量），还是同一仓库的两个分支，<code>GH_REF</code>变量值都是GitHub存放生成网页文件的仓库地址。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="c-3"><p>①安装yuque-hexo插件（<code>npm i --save-dev yuque-hexo</code>）</p>
<p>②修改根目录下的package.json：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;build&quot;</span>: <span class="string">&quot;hexo generate&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;clean&quot;</span>: <span class="string">&quot;hexo clean&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;deploy&quot;</span>: <span class="string">&quot;hexo deploy&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;server&quot;</span>: <span class="string">&quot;hexo server&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;sync&quot;</span>: <span class="string">&quot;yuque-hexo sync&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;clean:yuque&quot;</span>: <span class="string">&quot;yuque-hexo clean&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;reset&quot;</span>: <span class="string">&quot;npm run clean:yuque &amp;&amp; npm run sync&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="string">&quot;yuqueConfig&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;postPath&quot;</span>: <span class="string">&quot;source/_posts/a&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;mdNameFormat&quot;</span>: <span class="string">&quot;title&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;adapter&quot;</span>: <span class="string">&quot;markdown&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;lastGeneratePath&quot;</span>: <span class="string">&quot;./yuque-lastgeneratetimestamp.txt&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;concurrency&quot;</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">&quot;baseUrl&quot;</span>: <span class="string">&quot;https://www.yuque.com/api/v2&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;login&quot;</span>: <span class="string">&quot;****&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;repo&quot;</span>: <span class="string">&quot;****&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;token&quot;</span>: <span class="string">&quot;*****&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;onlyPublished&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;onlyPublic&quot;</span>: <span class="literal">true</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p><code>login</code>填语雀设置的用户个人路径字符，<code>repo</code>填语雀知识库的路径字符，<code>token</code>填语雀设置的Token字符，其他参数可参考<a target="_blank" rel="noopener" href="https://github.com/x-cold/yuque-hexo">官方解释</a>自定义配置。</p>
<p>③备份好<code>_post</code>文件夹后，本地终端运行<code>yuque-hexo sync</code>下载语雀文章，运行<code>yuque-hexo clean</code>清除语雀文章，运行<code>hexo g &amp; hexo s</code>本地调试效果。</p>
<p>⑤在网站源码根目录下创建<code>.travis.yml</code></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">language:</span> <span class="string">node_js</span> <span class="comment"># 设置语言</span></span><br><span class="line"><span class="attr">node_js:</span> <span class="string">node</span> <span class="comment"># 设置相应版本</span></span><br><span class="line"><span class="attr">os:</span> <span class="string">windows</span> <span class="comment"># 操作系统</span></span><br><span class="line"><span class="attr">cache:</span></span><br><span class="line">  <span class="attr">apt:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">directories:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">node_modules</span> <span class="comment"># 缓存不经常更改的内容</span></span><br><span class="line"><span class="comment"># 邮件通知成功或是失败</span></span><br><span class="line"><span class="attr">notifications:</span></span><br><span class="line">  <span class="attr">email:</span></span><br><span class="line">    <span class="attr">recipients:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">name1@mail.com</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">name2@mail.com</span></span><br><span class="line">    <span class="attr">on_success:</span> <span class="string">always</span> <span class="comment"># 默认值 change 不通知</span></span><br><span class="line">    <span class="attr">on_failure:</span> <span class="string">always</span> <span class="comment"># 默认值 always 通知</span></span><br><span class="line"></span><br><span class="line"><span class="attr">before_install:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">export</span> <span class="string">TZ=&#x27;Asia/Shanghai&#x27;</span> <span class="comment"># 更改时区</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">hexo-cli</span> <span class="string">-g</span> <span class="comment"># 安装依赖</span></span><br><span class="line"><span class="attr">install:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">npm</span> <span class="string">install</span> <span class="comment"># 安装hexo及插件</span></span><br><span class="line"><span class="attr">script:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">hexo</span> <span class="string">clean</span> <span class="comment"># 清除</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">hexo</span> <span class="string">g</span> <span class="comment"># 生成</span></span><br><span class="line"><span class="comment">#前5句保护部署分支的.git文件夹，用于保留历史部署的commit日志，否则部署分支永远只有一条commit记录</span></span><br><span class="line"><span class="comment">#变量在Travis中配置Environment Variables</span></span><br><span class="line"><span class="attr">after_script:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">git</span> <span class="string">clone</span> <span class="string">https://$&#123;GH_REF&#125;</span> <span class="string">.deploy_git</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">cd</span> <span class="string">.deploy_git</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">git</span> <span class="string">checkout</span> <span class="string">master</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">cd</span> <span class="string">../</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">mv</span> <span class="string">.deploy_git/.git/</span> <span class="string">./public/</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">cd</span> <span class="string">./public</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">git</span> <span class="string">config</span> <span class="string">user.name</span> <span class="string">&quot;$&#123;U_NAME&#125;&quot;</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">git</span> <span class="string">config</span> <span class="string">user.email</span> <span class="string">&quot;$&#123;U_EMAIL&#125;&quot;</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">git</span> <span class="string">add</span> <span class="string">.</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">git</span> <span class="string">commit</span> <span class="string">-m</span> <span class="string">&quot;Travis CI AutoUpdate `date +&quot;</span><span class="string">%Y-%m-%d</span> <span class="string">%H:%M&quot;`&quot;</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">git</span> <span class="string">push</span> <span class="string">--force</span> <span class="string">--quiet</span> <span class="string">&quot;https://$&#123;Travis_Token&#125;@$&#123;GH_REF&#125;&quot;</span> <span class="string">master:master</span> <span class="comment">#部署Github Pages</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">git</span> <span class="string">push</span> <span class="string">--force</span> <span class="string">--quiet</span> <span class="string">&quot;https://$&#123;CO_N&#125;:$&#123;Abcdefghij&#125;@$&#123;CO_REF&#125;&quot;</span> <span class="string">master:master</span> <span class="comment">#部署Coding Pages</span></span><br><span class="line"></span><br><span class="line"><span class="attr">branches:</span></span><br><span class="line">  <span class="attr">only:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">hexo</span> <span class="comment"># 只监测hexo分支</span></span><br></pre></td></tr></table></figure>
<p>注意将<code>${Abcdefghij}</code>更改成自己的令牌用户名；若需要开启邮件通知，将<code>name@mail.com</code>更改成自己的邮箱地址。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="c-4"><p>腾讯云登录云函数：新建空白函数；自定义函数名称，运行环境选择<code>PHP 7</code>；触发器选择<code>API网关触发器</code>。<br>
进入代码编辑页面，输入以下代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main_handler</span>(<span class="params"><span class="variable">$event</span>, <span class="variable">$context</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 解析语雀post的数据</span></span><br><span class="line">    <span class="variable">$update_title</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$event</span>-&gt;body)&#123;</span><br><span class="line">        <span class="variable">$yuque_data</span>= json_decode(<span class="variable">$event</span>-&gt;body);</span><br><span class="line">        <span class="variable">$update_title</span> .= <span class="variable">$yuque_data</span>-&gt;data-&gt;title;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// default params</span></span><br><span class="line">    <span class="variable">$repos</span> = <span class="string">&#x27;xxxx&#x27;</span>;  <span class="comment">// 你的仓库id 或 slug</span></span><br><span class="line">    <span class="variable">$token</span> = <span class="string">&#x27;xxxxxx&#x27;</span>; <span class="comment">// 你的登录token</span></span><br><span class="line">    <span class="variable">$message</span> = date(<span class="string">&quot;Y/m/d&quot;</span>).<span class="string">&#x27;yuque update&#x27;</span>.<span class="variable">$update_title</span>;</span><br><span class="line">    <span class="variable">$branch</span> = <span class="string">&#x27;master&#x27;</span>;</span><br><span class="line">    <span class="comment">// post params</span></span><br><span class="line">    <span class="variable">$queryString</span> = <span class="variable">$event</span>-&gt;queryString;</span><br><span class="line">    <span class="variable">$q_token</span> = <span class="variable">$queryString</span>-&gt;token ? <span class="variable">$queryString</span>-&gt;token : <span class="variable">$token</span>;</span><br><span class="line">    <span class="variable">$q_repos</span> = <span class="variable">$queryString</span>-&gt;repos ? <span class="variable">$queryString</span>-&gt;repos : <span class="variable">$repos</span>;</span><br><span class="line">    <span class="variable">$q_message</span> = <span class="variable">$queryString</span>-&gt;message ? <span class="variable">$queryString</span>-&gt;message : <span class="variable">$message</span>;</span><br><span class="line">    <span class="variable">$q_branch</span> = <span class="variable">$queryString</span>-&gt;branch ? <span class="variable">$queryString</span>-&gt;branch : <span class="string">&#x27;master&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="variable">$q_token</span>);</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&#x27;===&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="variable">$q_repos</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="string">&#x27;===&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="variable">$q_message</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="string">&#x27;===&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="variable">$q_branch</span>);</span><br><span class="line">    <span class="keyword">echo</span> (<span class="string">&#x27;===&#x27;</span>);</span><br><span class="line">    <span class="comment">//request travis ci</span></span><br><span class="line">    <span class="variable">$res_info</span> = triggerTravisCI(<span class="variable">$q_repos</span>, <span class="variable">$q_token</span>, <span class="variable">$q_message</span>, <span class="variable">$q_branch</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$res_code</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$res_message</span> = <span class="string">&#x27;未知&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$res_info</span>[<span class="string">&#x27;http_code&#x27;</span>])&#123;</span><br><span class="line">        <span class="variable">$res_code</span> = <span class="variable">$res_info</span>[<span class="string">&#x27;http_code&#x27;</span>];</span><br><span class="line">        <span class="keyword">switch</span>(<span class="variable">$res_info</span>[<span class="string">&#x27;http_code&#x27;</span>])&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="number">202</span>:</span><br><span class="line">                <span class="variable">$res_message</span> = <span class="string">&#x27;success&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="variable">$res_message</span> = <span class="string">&#x27;faild&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$res</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;status&#x27;</span>=&gt;<span class="variable">$res_code</span>,</span><br><span class="line">        <span class="string">&#x27;message&#x27;</span>=&gt;<span class="variable">$res_message</span></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* <span class="doctag">@description</span>  travis api , trigger a build</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $repos string 仓库ID、slug</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $token string 登录验证token</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $message string 触发信息</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> $branch string 分支</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> $info array 回包信息</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">triggerTravisCI</span> (<span class="params"><span class="variable">$repos</span>, <span class="variable">$token</span>, <span class="variable">$message</span>=<span class="string">&#x27;yuque update&#x27;</span>, <span class="variable">$branch</span>=<span class="string">&#x27;master&#x27;</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//初始化</span></span><br><span class="line">    <span class="variable">$curl</span> = curl_init();</span><br><span class="line">    <span class="comment">//设置抓取的url</span></span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_URL, <span class="string">&#x27;https://api.travis-ci.org/repo/&#x27;</span>.<span class="variable">$repos</span>.<span class="string">&#x27;/requests&#x27;</span>);</span><br><span class="line">    <span class="comment">//设置获取的信息以文件流的形式返回，而不是直接输出。</span></span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">    <span class="comment">//设置post方式提交</span></span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_CUSTOMREQUEST, <span class="string">&quot;POST&quot;</span>);</span><br><span class="line">    <span class="comment">//设置post数据</span></span><br><span class="line">    <span class="variable">$post_data</span> = json_encode(<span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&quot;request&quot;</span>=&gt; <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&quot;message&quot;</span>=&gt;<span class="variable">$message</span>,</span><br><span class="line">            <span class="string">&quot;branch&quot;</span>=&gt;<span class="variable">$branch</span></span><br><span class="line">        )</span><br><span class="line">    ));</span><br><span class="line">    <span class="variable">$header</span> = <span class="keyword">array</span>(</span><br><span class="line">      <span class="string">&#x27;Content-Type: application/json&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;Travis-API-Version: 3&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;Authorization:token &#x27;</span>.<span class="variable">$token</span>,</span><br><span class="line">      <span class="string">&#x27;Content-Length:&#x27;</span> . strlen(<span class="variable">$post_data</span>)</span><br><span class="line">    );</span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_HTTPHEADER, <span class="variable">$header</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$curl</span>, CURLOPT_POSTFIELDS, <span class="variable">$post_data</span>);</span><br><span class="line">    <span class="comment">//执行命令</span></span><br><span class="line">    <span class="variable">$data</span> = curl_exec(<span class="variable">$curl</span>);</span><br><span class="line">    <span class="variable">$info</span> = curl_getinfo(<span class="variable">$curl</span>);</span><br><span class="line">    <span class="comment">//关闭URL请求</span></span><br><span class="line">    curl_close(<span class="variable">$curl</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$info</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>其中branch的<code>master</code>要换成自己的源码分支名，第64行设置抓取的url要更换成自己仓库的Travis CI所在站点（如私库一般要换成<code>'https://api.travis-ci.com/repo/'</code>）。<br>
源码仓库id或slug以及登录token的获取：<br>
①在<a target="_blank" rel="noopener" href="https://developer.travis-ci.com/gettingstarted">Travis CI API Guide-Getting started</a>的Example GET Request处代码框看到自己的<code>login</code>的值（一般为用户名），以及登录<code>token</code>；<br>
②在<a target="_blank" rel="noopener" href="https://developer.travis-ci.com/explore/#explorer">Travis CI API Guide-API Explorer</a>的测试端点框输入<code>/owner/{login}/repos</code>（<code>{login}</code>替换成自己的值）找到源码仓库的<code>id</code>（一串数字）或<code>slug</code>（一般为<code>用户名/仓库名</code>的格式）。<br>
③在<a target="_blank" rel="noopener" href="https://app.travis-ci.com/account/preferences">Travis CI account setting</a>页点击复制API authentication的<code>COPY TOKEN</code>，与第一步得到的token值是一样的。</p>
<p>配置好触发器后，复制API链接（形如<code>https://service-***-***.bj.apigw.tencentcs.com/release/***</code>）</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<h4 id="coding-ci语雀"><a class="markdownIt-Anchor" href="#coding-ci语雀"></a> Coding CI+语雀</h4>
<p>Coding自动化部署参考<a target="_blank" rel="noopener" href="https://luan.ma/post/yuque2blog/">教程：静态博客使用语雀编辑器 （2020更新）</a></p>
<h4 id="vercel"><a class="markdownIt-Anchor" href="#vercel"></a> Vercel</h4>
<p>Vercel网站托管与部署、serverless部署参考<a target="_blank" rel="noopener" href="https://i-tech.tech/iloveu/44d57db9.html">vercel是什么神仙网站？</a>（②<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/347990778">知乎地址</a>）</p>
<h2 id="三css-js等源码优化"><a class="markdownIt-Anchor" href="#三css-js等源码优化"></a> （三）css、js等源码优化</h2>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42441117/article/details/81060497">CSS优化</a>；<a target="_blank" rel="noopener" href="https://blog.csdn.net/lululul123/article/details/76167861">css优化，js优化以及web性能优化</a>；<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35401191/article/details/81639109">CSS3性能优化</a><br>
<a target="_blank" rel="noopener" href="http://www.mb5u.com/tool/cssjianfei/">CSS整理与优化工具</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/lean1252/article/details/83874710">js批量设置style属性-lean1252-CSDN博客</a></p>
<h2 id="四seo优化"><a class="markdownIt-Anchor" href="#四seo优化"></a> （四）SEO优化</h2>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/42278823">LaTeX - 从出门到掉坑</a></p>
<h1 id="二-细节功能篇"><a class="markdownIt-Anchor" href="#二-细节功能篇"></a> 二、细节功能篇</h1>
<h2 id="永久文章链接"><a class="markdownIt-Anchor" href="#永久文章链接"></a> 永久文章链接</h2>
<p>方案1：_config.yml配置或Front-matter指定<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/permalinks">永久链接（Permalinks）</a><br>
方案2：插件<a target="_blank" rel="noopener" href="https://github.com/rozbo/hexo-abbrlink">hexo-abbrlink</a>实现<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/134492757">Hexo 生成永久文章链接</a></p>
<h2 id="不蒜子访问统计"><a class="markdownIt-Anchor" href="#不蒜子访问统计"></a> 不蒜子访问统计</h2>
<p>Butterfly已集成不蒜子，可选侧边栏网站资讯、文章信息处阅读量。</p>
<p>可在任何想放置访问信息的地方（页脚或其他页面位置）加入代码,但要修改适配文件语法格式。<br>
教程：<a target="_blank" rel="noopener" href="https://blog.csdn.net/erhuobuer/article/details/95305495">hexo添加live2d看板娘和不蒜子访问统计</a></p>
<div class="tabs" id="b"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#b-1">swig代码参考</button></li><li class="tab"><button type="button" data-href="#b-2">pug代码参考</button></li><li class="tab"><button type="button" data-href="#b-3">网站运行天数代码</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="b-1"><p>参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39720594/article/details/105411030">Hexo 页脚增加网站运行时间统计</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="b-2"><p>参考<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1687643">impressionyang-为主题用pugjs编写的hexo博客添加网站运行时间</a>来设置。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">div</span><br><span class="line">  span#timeDate 载入天数...</span><br><span class="line">  span#times 载入时分秒...</span><br><span class="line">  script.</span><br><span class="line">    var now = new Date();</span><br><span class="line">    function createtime() &#123;</span><br><span class="line">    var grt= new Date(&quot;08/13/2018 00:00:00&quot;);</span><br><span class="line">    now.setTime(now.getTime()+250);</span><br><span class="line">    days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);</span><br><span class="line">    hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);</span><br><span class="line">    if(String(hnum).length ==1 )&#123;hnum = &quot;0&quot; + hnum;&#125; minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);</span><br><span class="line">    mnum = Math.floor(minutes); if(String(mnum).length ==1 )&#123;mnum = &quot;0&quot; + mnum;&#125;</span><br><span class="line">    seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);</span><br><span class="line">    snum = Math.round(seconds); if(String(snum).length ==1 )&#123;snum = &quot;0&quot; + snum;&#125;</span><br><span class="line">    document.getElementById(&quot;timeDate&quot;).innerHTML = &quot;本站已安全运行 &quot;+dnum+&quot; 天 &quot;;</span><br><span class="line">    document.getElementById(&quot;times&quot;).innerHTML = hnum + &quot; 小时 &quot; + mnum + &quot; 分 &quot; + snum + &quot; 秒&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    setInterval(&quot;createtime()&quot;,250);</span><br></pre></td></tr></table></figure>
<p>修改<code>var grt= new Date(&quot;08/13/2018 00:00:00&quot;);</code>中的起始时间即可。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="b-3"><p>参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/shenjingwa/p/14465251.html">网站运行天数代码</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<h2 id="云写作"><a class="markdownIt-Anchor" href="#云写作"></a> 云写作</h2>
<p>源码参考<a target="_blank" rel="noopener" href="https://pandao.github.io/editor.md/">Editor.md</a>以及<a target="_blank" rel="noopener" href="https://github.com/debuggerx01/md_editor_for_hexo">md_editor_for_hexo</a><br>
教程参考<a target="_blank" rel="noopener" href="http://www.debuggerx.com/2020/11/08/an-awesome-markdown-editor-for-hexo/">为博客加入一个好用的在线MD编辑工具</a></p>
<h2 id="在线聊天"><a class="markdownIt-Anchor" href="#在线聊天"></a> 在线聊天</h2>
<h3 id="tidio"><a class="markdownIt-Anchor" href="#tidio"></a> Tidio</h3>
<p><a target="_blank" rel="noopener" href="https://www.tidio.com/">Tido</a><br>
<a target="_blank" rel="noopener" href="https://www.cifnews.com/tag/tidiolivechat">Tidio Live Chat 安装到Shopify店铺的步骤</a></p>
<h2 id="评论"><a class="markdownIt-Anchor" href="#评论"></a> 评论</h2>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/cungudafa/article/details/105699384">valine评论移植；关于页boyui对话框式简介</a><br>
<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38157825/article/details/112783083">Valine评论；在线聊天；分析统计；广告；网站验证；hexo-douban插件；Pjax</a></p>
<h2 id="分页展示内容"><a class="markdownIt-Anchor" href="#分页展示内容"></a> 分页展示内容</h2>
<ul>
<li>liyang<a target="_blank" rel="noopener" href="https://liyangzone.com/2019/07/22/hexo%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E4%B8%80%E7%BA%A7%E5%88%86%E7%B1%BB%E7%9B%B8%E5%86%8C/">hexo博客添加一级分类相册功能</a></li>
</ul>
<h1 id="三-魔改源码篇"><a class="markdownIt-Anchor" href="#三-魔改源码篇"></a> 三、魔改源码篇</h1>
<h2 id="关于代码含义的教程"><a class="markdownIt-Anchor" href="#关于代码含义的教程"></a> 关于代码含义的教程</h2>
<p>《一只看不懂函数名含义只会画瓢的小松鼠囤的干货》</p>
<p>JS/JQuery文件</p>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000039182220">你应该会喜欢的5个自定义 Hook-Segmentfault思否</a></p>
</li>
<li>
<p>JQuery事件的含义：<a target="_blank" rel="noopener" href="https://blog.csdn.net/aerchi/article/details/80017942">JS里addEventListener和on的区别-打杂人-CSDN博客</a></p>
</li>
</ul>
<p>styl/Stylus文件</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.jc2182.com/stylus/stylus-jiaocheng.html">Stylus 教程 - 蝴蝶教程</a></li>
</ul>
<h2 id="多设备显示适配"><a class="markdownIt-Anchor" href="#多设备显示适配"></a> 多设备显示适配</h2>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_47443027/article/details/115415455">媒体查询，响应式布局设计-火兰-CSDN博客</a></p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://www.bbsmax.com/A/A2dmxKAn5e/">JS 获取和监听屏幕方向变化（portrait / landscape）</a></p>
</li>
</ul>
<h2 id="文章页sidebar侧边栏目录"><a class="markdownIt-Anchor" href="#文章页sidebar侧边栏目录"></a> 文章页sidebar侧边栏目录</h2>
<p><code>addListener</code>已弃用，参考<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/56466261/matchmedia-addlistener-marked-as-deprecated-addeventlistener-equivalent">javascript - matchMedia().addListener marked as deprecated, addEventListener equivalent? - Stack Overflow</a>的回答修改。</p>
<h2 id="定制404页面"><a class="markdownIt-Anchor" href="#定制404页面"></a> 定制404页面</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.zhheo.com/p/f48e518b.html">Butterfly魔改：404页面展示最近文章</a></li>
</ul>
<h1 id="四-可选插件"><a class="markdownIt-Anchor" href="#四-可选插件"></a> 四、可选插件</h1>
<p>网站根目录下的<code>package.json</code>内的<code>dependencies</code>是所有<code>npm install * --save</code>（<code>*</code>通配插件名）以及手动写入的插件依赖。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/xbotao/hexo-admin-qiniu">GitHub - xbotao/hexo-admin-qiniu: 根据hexo-admin@2.2.0进行修改，添加粘贴图片上传至七牛</a><br>
代码语言高亮渲染</li>
<li><a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo-renderer-pug">hexo-renderer-pug</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo-renderer-stylus">hexo-renderer-stylus</a></li>
</ul>
</article><div class="post-end"><span class="p">—— 待续 ——</span></div><div class="co"><div class="co-author"><span class="co-i">作者 排版 /   </span><a class="co-c" href="2952068332@qq.com">惊蛰</a></div><div class="co-notice"><span class="co-c">原创   <a class="co-c" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></span><span class="co-info">   </span><span class="co-info">本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处：<a href="https://fgggh.cn/post/06function/" target="_blank">浮光河</a></span></div></div><div class="tag_share"><div class="tags"><div class="tag"><span class="tagi">#</span><a href="/tags/hexo/">hexo</a><span class="tagn">7</span></div><div class="tag"><span class="tagi">#</span><a href="/tags/butterfly/">butterfly</a><span class="tagn">4</span></div></div><div class="post_share"><div class="social-share" data-image="https://www.xinruiyun.cn/ms-mcms/upload/1/editor/1580979167449.jpg" data-sites="weibo,wechat,douban,qq,twitter,linkedin,facebook"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/waldenlak/plugins/share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/waldenlak/plugins/share.js/dist/js/social-share.min.js" defer></script></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="ri-shuffle-fill"><span>目录</span></i><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80-%E5%BC%95%E6%93%8E%E4%BC%98%E5%8C%96%E7%AF%87"><span class="toc-number">1.</span> <span class="toc-text"> 一、引擎优化篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E8%AE%BF%E9%97%AE%E5%8A%A0%E9%80%9F"><span class="toc-number">1.1.</span> <span class="toc-text"> （一）访问加速</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cdn%E5%8A%A0%E9%80%9F"><span class="toc-number">1.1.1.</span> <span class="toc-text"> CDN加速</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%BF%87hexo%E7%9A%84%E6%B8%B2%E6%9F%93"><span class="toc-number">1.1.2.</span> <span class="toc-text"> 跳过HEXO的渲染</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E5%8F%8C%E7%BA%BF%E9%83%A8%E7%BD%B2%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2%E6%95%99%E7%A8%8B"><span class="toc-number">1.2.</span> <span class="toc-text"> （二）双线部署+自动部署教程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E5%A4%87%E4%BB%BD"><span class="toc-number">1.2.1.</span> <span class="toc-text"> 镜像备份</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2"><span class="toc-number">1.2.2.</span> <span class="toc-text"> 自动部署</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#github-action%E8%AF%AD%E9%9B%80"><span class="toc-number">1.2.2.1.</span> <span class="toc-text"> Github Action+语雀</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#travis-ci%E8%AF%AD%E9%9B%80"><span class="toc-number">1.2.2.2.</span> <span class="toc-text"> Travis CI+语雀</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#coding-ci%E8%AF%AD%E9%9B%80"><span class="toc-number">1.2.2.3.</span> <span class="toc-text"> Coding CI+语雀</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#vercel"><span class="toc-number">1.2.2.4.</span> <span class="toc-text"> Vercel</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89css-js%E7%AD%89%E6%BA%90%E7%A0%81%E4%BC%98%E5%8C%96"><span class="toc-number">1.3.</span> <span class="toc-text"> （三）css、js等源码优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9Bseo%E4%BC%98%E5%8C%96"><span class="toc-number">1.4.</span> <span class="toc-text"> （四）SEO优化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C-%E7%BB%86%E8%8A%82%E5%8A%9F%E8%83%BD%E7%AF%87"><span class="toc-number">2.</span> <span class="toc-text"> 二、细节功能篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B8%E4%B9%85%E6%96%87%E7%AB%A0%E9%93%BE%E6%8E%A5"><span class="toc-number">2.1.</span> <span class="toc-text"> 永久文章链接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E8%92%9C%E5%AD%90%E8%AE%BF%E9%97%AE%E7%BB%9F%E8%AE%A1"><span class="toc-number">2.2.</span> <span class="toc-text"> 不蒜子访问统计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%91%E5%86%99%E4%BD%9C"><span class="toc-number">2.3.</span> <span class="toc-text"> 云写作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E7%BA%BF%E8%81%8A%E5%A4%A9"><span class="toc-number">2.4.</span> <span class="toc-text"> 在线聊天</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tidio"><span class="toc-number">2.4.1.</span> <span class="toc-text"> Tidio</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%84%E8%AE%BA"><span class="toc-number">2.5.</span> <span class="toc-text"> 评论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E5%B1%95%E7%A4%BA%E5%86%85%E5%AE%B9"><span class="toc-number">2.6.</span> <span class="toc-text"> 分页展示内容</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89-%E9%AD%94%E6%94%B9%E6%BA%90%E7%A0%81%E7%AF%87"><span class="toc-number">3.</span> <span class="toc-text"> 三、魔改源码篇</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E4%BB%A3%E7%A0%81%E5%90%AB%E4%B9%89%E7%9A%84%E6%95%99%E7%A8%8B"><span class="toc-number">3.1.</span> <span class="toc-text"> 关于代码含义的教程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%AE%BE%E5%A4%87%E6%98%BE%E7%A4%BA%E9%80%82%E9%85%8D"><span class="toc-number">3.2.</span> <span class="toc-text"> 多设备显示适配</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E7%AB%A0%E9%A1%B5sidebar%E4%BE%A7%E8%BE%B9%E6%A0%8F%E7%9B%AE%E5%BD%95"><span class="toc-number">3.3.</span> <span class="toc-text"> 文章页sidebar侧边栏目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E5%88%B6404%E9%A1%B5%E9%9D%A2"><span class="toc-number">3.4.</span> <span class="toc-text"> 定制404页面</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B-%E5%8F%AF%E9%80%89%E6%8F%92%E4%BB%B6"><span class="toc-number">4.</span> <span class="toc-text"> 四、可选插件</span></a></li></ol></div></div></div></div><div class="wid" id="aside-content"><div class="sticky_layout"></div></div></main><main class="after" id="after-inner"><div class="pag-post"><nav class="pag-post" id="pagination"><div class="prev-post pull-left"><a href="/post/05css&amp;js/"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">建站05-外加css/js样式记录</div></div></a></div><div class="next-post pull-right"><a href="/post/07design/"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">建站07-butterfly主题样式魔改记录</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="ri-magic-fill"></i><span>相关内容</span></div><div class="relatedPosts-list"><div><a href="/post/04config/" title="建站04-hexo源码文件看不懂？"><img class="cover" src="https://cdn.jsdelivr.net/gh/waldenlak/Art/imgs/t7.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="ri-calendar-event-fill fa-fw"></i> 2021-08-31</div><div class="title">建站04-hexo源码文件看不懂？</div></div></a></div><div><a href="/post/05css&js/" title="建站05-外加css&#x2F;js样式记录"><img class="cover" src="https://cdn.jsdelivr.net/gh/waldenlak/Art/imgs/t6.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="ri-calendar-event-fill fa-fw"></i> 2021-08-31</div><div class="title">建站05-外加css&#x2F;js样式记录</div></div></a></div><div><a href="/post/07design/" title="建站07-butterfly主题样式魔改记录"><img class="cover" src="https://cdn.jsdelivr.net/gh/waldenlak/Art/imgs/t0.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="ri-calendar-event-fill fa-fw"></i> 2021-08-31</div><div class="title">建站07-butterfly主题样式魔改记录</div></div></a></div><div><a href="/post/02steps/" title="建站02-详细步骤"><img class="cover" src="https://cdn.jsdelivr.net/gh/waldenlak/Art/imgs/t3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="ri-calendar-event-fill fa-fw"></i> 2021-08-23</div><div class="title">建站02-详细步骤</div></div></a></div><div><a href="/post/03git&npm&hexo/" title="建站03-执行代码-git\npm\hexo常用执行命令"><img class="cover" src="https://gitforwindows.org/img/details_features.png" alt="cover"><div class="content is-center"><div class="date"><i class="ri-calendar-event-fill fa-fw"></i> 2021-08-23</div><div class="title">建站03-执行代码-git\npm\hexo常用执行命令</div></div></a></div><div><a href="/post/10markdown/" title="markdown语法表、渲染配置与编辑器"><img class="cover" src="https://gitee.com/waking-insects/pic/raw/master/cov/md.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="ri-calendar-event-fill fa-fw"></i> 2021-09-06</div><div class="title">markdown语法表、渲染配置与编辑器</div></div></a></div></div></div></div><div class="com"><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div></main><footer id="footer" style="background: #e4edff"><div id="footer-wrap"><div class="copyright">2021 - 2022 &copy; 浮光河 - 雕刻我的构想，展览你的描绘</div><div class="framework-info"><span class="footer-info">Crafted with </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-info">-</span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a><span class="footer-info"> by 惊蛰 子诺</span></div></div></footer></div><div id="rightside"><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="ri-shuffle-fill"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索内容</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="输入关键词查找" type="text"/></div></div><div id="local-search-results"></div></div><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  加载中</span></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://unpkg.com/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://unpkg.com/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: '',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: '',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://unpkg.com/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script async src="/js/fgh.js"></script><script async data-pjax src="/js/randombg.js"></script><script defer src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script id="canvas_nest" defer="defer" color="201,214,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://unpkg.com/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>